<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather Tables 2.0 - CR</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poetsen+One&display=swap"
      rel="stylesheet"
    />
    <style>
      html {
        font-family:
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          Oxygen,
          Ubuntu,
          Cantarell,
          "Open Sans",
          "Helvetica Neue",
          sans-serif;
        font-weight: 400;
      }
      body {
        margin: 0;
      }
      p {
        margin: 0;
      }
      .page-container {
        margin: auto;
        max-width: 1180px;
        padding-bottom: 2rem;
      }
      .navigation-container {
        position: sticky;
        top: 0;
        background-color: #ffffff;
        border-bottom: 2px solid #d0d0d0;
        padding: 15px;
        margin-bottom: 20px;
        z-index: 100;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      .nav-section {
        margin-bottom: 15px;
      }
      .nav-section-title {
        font-weight: bold;
        font-size: 14px;
        color: #666;
        margin-bottom: 8px;
        text-transform: uppercase;
      }
      .nav-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }
      .nav-button {
        background-color: #f0f0f0;
        color: #333;
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 8px 12px;
        font-size: 13px;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
      }
      .nav-button:hover {
        background-color: #e0e0e0;
        border-color: #999;
      }
      .day-nav-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        margin-top: 5px;
      }
      .day-nav-button {
        background-color: #ffffff;
        color: #0036d6;
        border: 1px solid #0036d6;
        border-radius: 3px;
        padding: 4px 8px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
      }
      .day-nav-button:hover {
        background-color: #0036d6;
        color: #ffffff;
      }
      .region-container {
        margin-bottom: 40px;
        scroll-margin-top: 200px;
      }
      .day-container {
        background-color: #f9f9f9;
        border: 2px solid #d0d0d0;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        scroll-margin-top: 200px;
      }
      .day-container-header {
        font-size: 20px;
        font-weight: bold;
        color: #0036d6;
        margin-bottom: 15px;
        padding-bottom: 8px;
        border-bottom: 2px solid #0036d6;
      }
      .custom-weather-table {
        margin-top: 20px;
        margin-bottom: 30px;
        border: 1px solid #dededf;
        height: 100%;
        width: 100%;
        table-layout: fixed;
        border-collapse: collapse;
        border-spacing: 1px;
        text-align: center;
        font-family: Arial, sans-serif;
      }
      .custom-weather-table th {
        border: 1px solid #dededf;
        background-color: #0036d6;
        text-align: center;
        color: white;
        padding: 10px 5px;
      }
      .custom-weather-table td {
        border: 1px solid #dededf;
        background-color: #ffffff;
        text-align: center;
        color: #000000;
        padding: 5px;
        vertical-align: top;
      }
      .table-date-header {
        font-size: 18px;
        font-weight: bold;
        margin-top: 20px;
        margin-bottom: 10px;
        color: #0036d6;
      }
      .export-button {
        background-color: #000000;
        color: #ffffff;
        border: none;
        border-radius: 5px;
        padding: 10px 15px;
        margin-top: 10px;
        margin-bottom: 10px;
        display: inline-block;
        cursor: pointer;
        font-weight: bold;
        margin-right: 10px;
      }
      .export-button:hover {
        background-color: #333333;
      }
      .copy-button {
        background-color: #f5f5f0;
        color: #333333;
        border: 1px solid #d0d0d0;
        border-radius: 5px;
        padding: 10px 15px;
        margin-top: 10px;
        margin-bottom: 10px;
        display: inline-block;
        cursor: pointer;
        font-weight: bold;
        margin-right: 10px;
      }
      .copy-button:hover {
        background-color: #e8e8e0;
      }
    </style>
    <script>
      (async () => {
        try {
          const DAYS_OF_WEEK = {
            SUNDAY: 0,
            MONDAY: 1,
            TUESDAY: 2,
            WEDNESDAY: 3,
            THURSDAY: 4,
            FRIDAY: 5,
            SATURDAY: 6,
          };

          const regions = [
            {
              label: "DC 49: Winnipeg",
              id: "dc49",
              primaryBackgroundColour: "#8300FF",
              cities: [
                {
                  label: "Winnipeg",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.854&long=-97.175&unit=metric&count=15&offset=0",
                },
                {
                  label: "Brandon",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.85&long=-99.96&unit=metric&count=15&offset=0",
                },
                {
                  label: "Morden",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.192&long=-98.112&unit=metric&count=15&offset=0",
                },
                {
                  label: "Thompson",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=55.76&long=-97.842&unit=metric&count=15&offset=0",
                },
                {
                  label: "Regina",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=50.455&long=-104.618&unit=metric&count=15&offset=0",
                },
                {
                  label: "Kenora",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.779&long=-94.467&unit=metric&count=15&offset=0",
                },
                {
                  label: "Thunder Bay",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=48.402&long=-89.31&unit=metric&count=15&offset=0",
                },
              ],
            },
            {
              label: "DC 56: Oshawa",
              id: "dc56",
              primaryBackgroundColour: "#009B43",
              cities: [
                {
                  label: "Kingston",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=44.242&long=-76.501&unit=metric&count=15&offset=0",
                },
                {
                  label: "Lindsay",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=44.353&long=-78.739&unit=metric&count=15&offset=0",
                },
                {
                  label: "Newmarket",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=44.05&long=-79.462&unit=metric&count=15&offset=0",
                },
                {
                  label: "Oshawa",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=43.941&long=-78.874&unit=metric&count=15&offset=0",
                },
                {
                  label: "Peterborough",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=44.315&long=-78.321&unit=metric&count=15&offset=0",
                },
                {
                  label: "Picton",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=44.005&long=-77.145&unit=metric&count=15&offset=0",
                },
                {
                  label: "Toronto",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=43.667&long=-79.407&unit=metric&count=15&offset=0",
                },
                {
                  label: "Ottawa",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=45.405&long=-75.695&unit=metric&count=15&offset=0",
                },
              ],
            },
            {
              label: "DC 06: Montreal",
              id: "dc06",
              primaryBackgroundColour: "#990070",
              cities: [
                {
                  label: "Montréal",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=45.507&long=-73.556&unit=metric&count=15&offset=0",
                },
                {
                  label: "Québec",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=46.814&long=-71.207&unit=metric&count=15&offset=0",
                },
                {
                  label: "Mont-Tremblant",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=46.203&long=-74.613&unit=metric&count=15&offset=0",
                },
                {
                  label: "Val-d'Or",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=48.099&long=-77.795&unit=metric&count=15&offset=0",
                },
                {
                  label: "Sept-Îles",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=50.213&long=-66.38&unit=metric&count=15&offset=0",
                },
                {
                  label: "Magog",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=45.267&long=-72.146&unit=metric&count=15&offset=0",
                },
                {
                  label: "Ottawa",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=45.405&long=-75.695&unit=metric&count=15&offset=0",
                },
                {
                  label: "Saguenay",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=48.435&long=-71.165&unit=metric&count=15&offset=0",
                },
                {
                  label: "Rouyn-Noranda",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=48.211&long=-79.053&unit=metric&count=15&offset=0",
                },
              ],
            },
            {
              label: "DC 17: Brampton",
              id: "dc17",
              primaryBackgroundColour: "#998C00",
              cities: [
                {
                  label: "Windsor",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=42.295&long=-82.995&unit=metric&count=15&offset=0",
                },
                {
                  label: "London",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=42.951&long=-81.249&unit=metric&count=15&offset=0",
                },
                {
                  label: "Hamilton",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=43.244&long=-79.837&unit=metric&count=15&offset=0",
                },
                {
                  label: "Brampton",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=43.725&long=-79.744&unit=metric&count=15&offset=0",
                },
                {
                  label: "Niagara Falls",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=43.051&long=-79.087&unit=metric&count=15&offset=0",
                },
                {
                  label: "Kitchener",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=43.43&long=-80.483&unit=metric&count=15&offset=0",
                },
                {
                  label: "Toronto",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=43.667&long=-79.407&unit=metric&count=15&offset=0",
                },
                {
                  label: "Barrie",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=44.37&long=-79.697&unit=metric&count=15&offset=0",
                },
                {
                  label: "Sault Ste. Marie",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=46.533&long=-84.368&unit=metric&count=15&offset=0",
                },
                {
                  label: "Timmins",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=48.494&long=-81.355&unit=metric&count=15&offset=0",
                },
                {
                  label: "Sudbury",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=46.485&long=-80.984&unit=metric&count=15&offset=0",
                },
              ],
            },
            {
              label: "DC 26: Vancouver",
              id: "dc26",
              primaryBackgroundColour: "#003D99",
              cities: [
                {
                  label: "Prince George",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=53.927&long=-122.765&unit=metric&count=15&offset=0",
                },
                {
                  label: "Smithers",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=54.791&long=-127.178&unit=metric&count=15&offset=0",
                },
                {
                  label: "Prince Rupert",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=54.29&long=-130.307&unit=metric&count=15&offset=0",
                },
                {
                  label: "Port Hardy",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=50.697&long=-127.456&unit=metric&count=15&offset=0",
                },
                {
                  label: "Victoria",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=48.427&long=-123.347&unit=metric&count=15&offset=0",
                },
                {
                  label: "Hope",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.374&long=-121.413&unit=metric&count=15&offset=0",
                },
                {
                  label: "Squamish",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.756&long=-123.118&unit=metric&count=15&offset=0",
                },
                {
                  label: "Sechelt",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.491&long=-123.799&unit=metric&count=15&offset=0",
                },
                {
                  label: "Vancouver",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.257&long=-123.113&unit=metric&count=15&offset=0",
                },
              ],
            },
            {
              label: "DC 34: Calgary",
              id: "dc34",
              primaryBackgroundColour: "#D13437",
              cities: [
                {
                  label: "Calgary",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=51.028&long=-114.05&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.MONDAY,
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.THURSDAY,
                    DAYS_OF_WEEK.FRIDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Red Deer",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=52.279&long=-113.791&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.MONDAY,
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Edmonton",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=53.556&long=-113.558&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.MONDAY,
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.THURSDAY,
                    DAYS_OF_WEEK.FRIDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Lethbridge",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.688&long=-112.852&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.FRIDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Medicine Hat",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=50.051&long=-110.705&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Lloydminster",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=53.278&long=-110.036&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Grande Prairie",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=55.16&long=-118.804&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                  ],
                },
                {
                  label: "Fort McMurray",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=56.718&long=-111.369&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.MONDAY,
                    DAYS_OF_WEEK.THURSDAY,
                  ],
                },
                {
                  label: "Peace River",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=56.232&long=-117.32&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [DAYS_OF_WEEK.MONDAY, DAYS_OF_WEEK.FRIDAY],
                },
                {
                  label: "Kelowna",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.9&long=-119.425&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.MONDAY,
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.THURSDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Golden",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=51.299&long=-116.964&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.MONDAY,
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.THURSDAY,
                    DAYS_OF_WEEK.FRIDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Kamloops",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=50.675&long=-120.326&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [DAYS_OF_WEEK.TUESDAY],
                },
                {
                  label: "Vernon",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=50.236&long=-119.357&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [DAYS_OF_WEEK.THURSDAY],
                },
                {
                  label: "Revelstoke",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=51.006&long=-118.221&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.FRIDAY,
                  ],
                },
                {
                  label: "Prince George",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=53.927&long=-122.765&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.FRIDAY,
                  ],
                },
                {
                  label: "Dawson Creek",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=55.757&long=-120.237&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                  ],
                },
                {
                  label: "Saskatoon",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=52.151&long=-106.663&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.MONDAY,
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.THURSDAY,
                    DAYS_OF_WEEK.FRIDAY,
                  ],
                },
                {
                  label: "Prince Albert",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=53.216&long=-105.714&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.SUNDAY,
                    DAYS_OF_WEEK.WEDNESDAY,
                  ],
                },
                {
                  label: "North Battleford",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=52.757&long=-108.294&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Melfort",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=52.856&long=-104.603&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.FRIDAY,
                  ],
                },
                {
                  label: "Drumheller",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=51.406&long=-112.618&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [DAYS_OF_WEEK.MONDAY, DAYS_OF_WEEK.FRIDAY],
                },
                {
                  label: "Fernie",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.505&long=-115.052&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Bonnyville",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=54.268&long=-110.755&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.MONDAY,
                    DAYS_OF_WEEK.THURSDAY,
                  ],
                },
                {
                  label: "Kindersley",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=51.467&long=-109.156&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [DAYS_OF_WEEK.MONDAY, DAYS_OF_WEEK.FRIDAY],
                },
                {
                  label: "Hinton",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=53.401&long=-117.573&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Castlegar",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.295&long=-117.654&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Cardston",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.194&long=-113.308&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [DAYS_OF_WEEK.SATURDAY],
                },
                {
                  label: "Invermere",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=50.505&long=-116.035&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.TUESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
                {
                  label: "Cranbrook",
                  url: "https://weatherapi.pelmorex.com/api/v1/longterm?locale=en-CA&lat=49.514&long=-115.761&unit=metric&count=15&offset=0",
                  daysOfWeekEnabled: [
                    DAYS_OF_WEEK.WEDNESDAY,
                    DAYS_OF_WEEK.SATURDAY,
                  ],
                },
              ],
            },
          ];

          // Configuration
          const START_DAY_INDEX = 1;
          const NUM_DAYS_TO_DISPLAY = 3;

          console.log("Starting data fetch...");

          // Fetch API data
          const regionsAPIData = await Promise.all(
            regions.map(async (region) => {
              const citiesAPIData = await Promise.all(
                region.cities.map(async (city) => {
                  try {
                    const res = await fetch(city.url);
                    const rawData = await res.json();

                    const daysData = [];
                    for (
                      let i = START_DAY_INDEX;
                      i < START_DAY_INDEX + NUM_DAYS_TO_DISPLAY;
                      i++
                    ) {
                      if (rawData.longTerm[i]) {
                        const dateObj = new Date(
                          rawData.longTerm[i].time.local,
                        );
                        const dayOfWeek = dateObj.getDay();

                        daysData.push({
                          date: dateObj.toLocaleDateString(),
                          dayOfWeek: dayOfWeek,
                          temperature:
                            rawData.longTerm[i].day.temperature.value,
                          snow: rawData.longTerm[i].snow.value,
                          wind: rawData.longTerm[i].day.wind.speed,
                          rain: rawData.longTerm[i].rain.value,
                        });
                      }
                    }

                    const cityUnits = {
                      snow: rawData.display.unit.snow,
                      wind: rawData.display.unit.wind,
                      temperature: rawData.display.unit.temperature,
                      rain: rawData.display.unit.rain,
                    };

                    return {
                      label: city.label,
                      daysData: daysData,
                      units: cityUnits,
                      daysOfWeekEnabled: city.daysOfWeekEnabled,
                    };
                  } catch (error) {
                    console.error(`Error fetching ${city.label}:`, error);
                    return null;
                  }
                }),
              );

              return {
                ...region,
                cities: citiesAPIData.filter((c) => c !== null),
              };
            }),
          );

          console.log("Data fetched:", regionsAPIData);

          // Add alerts
          const regionsData = regionsAPIData.map((region) => {
            const citiesData = region.cities.map((city) => {
              const daysWithAlerts = city.daysData.map((dayData) => {
                const windAlert = dayData.wind > 40;
                const snowAlert = dayData.snow > 0;
                const rainAlert = dayData.rain > 0;
                const generalAlert = windAlert || snowAlert || rainAlert;

                return {
                  ...dayData,
                  alert: {
                    wind: windAlert,
                    snow: snowAlert,
                    rain: rainAlert,
                    general: generalAlert,
                  },
                };
              });

              return {
                ...city,
                daysData: daysWithAlerts,
              };
            });

            return {
              ...region,
              cities: citiesData,
            };
          });

          // Helper function
          function calculateAdditionalTime(
            snowVal,
            rainVal,
            temperatureVal,
            regionLabel,
            cityLabel,
          ) {
            // Oshawa Logic for Additional Time
            if (regionLabel === "DC 56: Oshawa") {
              if (cityLabel === "Picton" && snowVal > 0) {
                return "15 mins before first stop";
              } else if (snowVal <= 3 && rainVal <= 3) {
                return "No changes";
              } else if (
                (snowVal > 3 && snowVal <= 5) ||
                (rainVal > 3 && rainVal <= 5)
              ) {
                return "15 mins before first stop";
              } else if (
                (snowVal > 5 && snowVal <= 10) ||
                (rainVal > 5 && rainVal <= 10)
              ) {
                return "15 mins before first stop + 15 mins between deliveries";
              } else {
                return "30 mins before first stop + 15 mins between deliveries";
              }
              // Montreal Temperature Threshold Logic for additional time
            } else if (regionLabel === "DC 06: Montreal") {
              if (snowVal > 3 && snowVal <= 5) {
                return "15 mins before first stop";
              } else if (snowVal > 5 && snowVal <= 10) {
                return "15 mins before first stop + 15 mins between deliveries";
              } else if (snowVal > 10) {
                return "30 mins before first stop + 15 mins between deliveries";
              } else if (temperatureVal <= -10 && temperatureVal > -18) {
                return "10 mins before first stop";
              } else if (temperatureVal <= -18 && temperatureVal > -25) {
                return "20 mins before first stop";
              } else if (temperatureVal <= -25) {
                return "30 mins before first stop";
              } else {
                return "No changes";
              }
              // Logic to have null comments for Vancouver weather tables
            } else if (regionLabel === "DC 26: Vancouver") {
              return "";
              // Logic for Brampton including request to add 15 mins of offload time to every delivery when temperature drops below -10C
              // } else if (regionLabel === "DC 17: Brampton") {
              //   if (snowVal > 3 && snowVal <= 5) {
              //     return "15 mins before first stop";
              //   } else if (snowVal > 5 && snowVal <= 10) {
              //     return "15 mins before first stop + 15 mins between deliveries";
              //   } else if (snowVal > 10) {
              //     return "30 mins before first stop + 15 mins between deliveries";
              //   } else if (temperatureVal <= -10) {
              //     return "Add 15 mins of offload time to every delivery";
              //   } else {
              //     return "No changes";
              //   }
              // Logic for additional time for all other DCs
            } else {
              if (snowVal <= 3) {
                return "No changes";
              } else if (snowVal > 3 && snowVal <= 5) {
                return "15 mins before first stop";
              } else if (snowVal > 5 && snowVal <= 10) {
                return "15 mins before first stop + 15 mins between deliveries";
              } else {
                return "30 mins before first stop + 15 mins between deliveries";
              }
            }
          }

          function calculateAdditionalTimeMTL(
            snowVal,
            rainVal,
            temperatureVal,
            regionLabel,
            cityLabel,
          ) {
            if (regionLabel === "DC 06: Montreal") {
              return "";
            }
          }

          function calculateAdditionalOffloadTimeBRP(
            temperatureVal,
            regionLabel,
            cityLabel,
          ) {
            if (regionLabel === "DC 17: Brampton") {
              if (temperatureVal <= -10 && temperatureVal > -20) {
                return "15 minutes";
              } else if (temperatureVal <= -20 && temperatureVal > -30) {
                return "20 minutes";
              } else if (temperatureVal <= -30) {
                return "25 minutes";
              } else {
                return "No changes";
              }
            }
          }

          const pageContainer = document.querySelector("#page-container");

          const mainHeader = document.createElement("h1");
          mainHeader.innerText = "Weather Tables 2.0";
          mainHeader.style.textAlign = "center";
          mainHeader.style.marginTop = "20px";
          pageContainer.appendChild(mainHeader);

          // Create navigation container
          const navContainer = document.createElement("div");
          navContainer.className = "navigation-container";
          pageContainer.appendChild(navContainer);

          // DC Quick Jump Buttons
          const dcNavSection = document.createElement("div");
          dcNavSection.className = "nav-section";
          navContainer.appendChild(dcNavSection);

          const dcNavTitle = document.createElement("div");
          dcNavTitle.className = "nav-section-title";
          dcNavTitle.innerText = "Jump to:";
          dcNavSection.appendChild(dcNavTitle);

          const dcNavButtons = document.createElement("div");
          dcNavButtons.className = "nav-buttons";
          dcNavSection.appendChild(dcNavButtons);

          // Create DC navigation buttons with day sub-buttons
          regionsData.forEach((region) => {
            if (region.cities.length === 0) return;

            const dcButtonContainer = document.createElement("div");
            dcButtonContainer.style.marginBottom = "2px";
            dcNavButtons.appendChild(dcButtonContainer);

            const dcButton = document.createElement("a");
            dcButton.className = "nav-button";
            dcButton.innerText = region.label;
            dcButton.href = `#region-${region.id}`;
            dcButton.style.fontWeight = "bold";
            dcButton.style.backgroundColor = region.primaryBackgroundColour;
            dcButton.style.color = "#ffffff";
            dcButton.style.borderColor = region.primaryBackgroundColour;
            dcButtonContainer.appendChild(dcButton);

            // Day buttons for this DC
            const dayButtonsContainer = document.createElement("div");
            dayButtonsContainer.className = "day-nav-buttons";
            dcButtonContainer.appendChild(dayButtonsContainer);

            const numDays = region.cities[0].daysData.length;
            for (let dayIndex = 0; dayIndex < numDays; dayIndex++) {
              const dayButton = document.createElement("a");
              dayButton.className = "day-nav-button";
              dayButton.innerText = region.cities[0].daysData[dayIndex].date;
              dayButton.href = `#${region.id}-day-${dayIndex}`;
              dayButtonsContainer.appendChild(dayButton);
            }
          });

          // Loop through each region
          regionsData.forEach((region) => {
            if (region.cities.length === 0) return;

            const regionContainer = document.createElement("div");
            regionContainer.className = "region-container";
            regionContainer.id = `region-${region.id}`;
            pageContainer.appendChild(regionContainer);

            const regionHeader = document.createElement("h2");
            regionContainer.appendChild(regionHeader);
            regionHeader.innerText = region.label;
            regionHeader.style.borderBottom = `4px solid ${region.primaryBackgroundColour}`;
            regionHeader.style.marginBottom = "20px";
            regionHeader.style.scrollMarginTop = "120px";

            const numDays = region.cities[0].daysData.length;

            // Create a day container for each day within this region
            for (let dayIndex = 0; dayIndex < numDays; dayIndex++) {
              const dayContainer = document.createElement("div");
              dayContainer.className = "day-container";
              dayContainer.id = `${region.id}-day-${dayIndex}`;
              regionContainer.appendChild(dayContainer);

              // Day header
              const dayHeader = document.createElement("div");
              dayHeader.className = "day-container-header";
              dayHeader.innerText = region.cities[0].daysData[dayIndex].date;
              dayContainer.appendChild(dayHeader);

              const tableContainer = document.createElement("div");
              dayContainer.appendChild(tableContainer);

              const table = document.createElement("table");
              table.className = "custom-weather-table";
              const thead = document.createElement("thead");
              const tbody = document.createElement("tbody");

              const headerRow = document.createElement("tr");
              const headerCategories = [
                "Region",
                "Temperature",
                "Snow (cm)",
                "Rain (mm)",
                "Wind (km/h)",
                "Guidelines",
                "Additional Time",
                "Added Offload Time to Each Stop",
              ];

              headerCategories.forEach((category) => {
                if (
                  category === "Wind (km/h)" &&
                  (region.label === "DC 56: Oshawa" ||
                    region.label === "DC 06: Montreal" ||
                    region.label === "DC 17: Brampton" ||
                    region.label === "DC 26: Vancouver")
                )
                  return;
                if (
                  category === "Temperature" &&
                  (region.label === "DC 49: Winnipeg" ||
                    region.label === "DC 56: Oshawa" ||
                    region.label === "DC 26: Vancouver" ||
                    region.label === "DC 34: Calgary")
                )
                  return;
                if (
                  category === "Guidelines" &&
                  (region.label === "DC 49: Winnipeg" ||
                    region.label === "DC 56: Oshawa" ||
                    region.label === "DC 26: Vancouver" ||
                    region.label === "DC 34: Calgary" ||
                    region.label === "DC 17: Brampton")
                )
                  return;
                if (
                  category === "Added Offload Time to Each Stop" &&
                  (region.label === "DC 49: Winnipeg" ||
                    region.label === "DC 56: Oshawa" ||
                    region.label === "DC 26: Vancouver" ||
                    region.label === "DC 34: Calgary" ||
                    region.label === "DC 06: Montreal")
                )
                  return;

                const th = document.createElement("th");
                th.textContent = category;
                headerRow.appendChild(th);
              });

              thead.appendChild(headerRow);
              table.appendChild(thead);
              table.appendChild(tbody);
              tableContainer.appendChild(table);

              const button = document.createElement("button");
              button.className = "export-button";
              button.innerText = `Export to CSV`;
              button.onclick = function () {
                exportTable(
                  table,
                  `${region.label}_${region.cities[0].daysData[dayIndex].date}_weather_data.csv`,
                );
              };
              tableContainer.appendChild(button);

              const copyButton = document.createElement("button");
              copyButton.className = "copy-button";
              copyButton.innerText = `Copy to Clipboard`;
              copyButton.onclick = function () {
                copyTableToClipboard(table);
              };
              tableContainer.appendChild(copyButton);

              region.cities.forEach((city) => {
                if (!city.daysData || !city.daysData[dayIndex]) return;

                const dayData = city.daysData[dayIndex];

                // For DC 34: Calgary, check if city is enabled for this day of week
                if (region.id === "dc34" && city.daysOfWeekEnabled) {
                  if (!city.daysOfWeekEnabled.includes(dayData.dayOfWeek)) {
                    return;
                  }
                }

                const row = document.createElement("tr");

                const regionCell = document.createElement("td");
                const cityLink = document.createElement("a");
                cityLink.textContent = city.label;
                cityLink.href = `https://www.theweathernetwork.com/en/city/${getCitySlug(
                  city.label,
                )}/hourly`;
                cityLink.target = "_blank";
                cityLink.style.color = "#0036d6";
                cityLink.style.textDecoration = "none";
                cityLink.style.fontWeight = "500";
                cityLink.onmouseover = function () {
                  this.style.textDecoration = "underline";
                };
                cityLink.onmouseout = function () {
                  this.style.textDecoration = "none";
                };
                regionCell.appendChild(cityLink);
                row.appendChild(regionCell);

                if (
                  !(
                    region.label === "DC 49: Winnipeg" ||
                    region.label === "DC 56: Oshawa" ||
                    region.label === "DC 26: Vancouver" ||
                    region.label === "DC 34: Calgary"
                  )
                ) {
                  const tempCell = document.createElement("td");
                  tempCell.textContent = `${dayData.temperature}°${city.units.temperature}`;
                  row.appendChild(tempCell);
                }

                const snowCell = document.createElement("td");
                snowCell.textContent = `${dayData.snow}`;
                row.appendChild(snowCell);

                const rainCell = document.createElement("td");
                rainCell.textContent = `${dayData.rain}`;
                row.appendChild(rainCell);

                if (
                  !(
                    region.label === "DC 56: Oshawa" ||
                    region.label === "DC 06: Montreal" ||
                    region.label === "DC 17: Brampton" ||
                    region.label === "DC 26: Vancouver"
                  )
                ) {
                  const windCell = document.createElement("td");
                  windCell.textContent = `${dayData.wind}`;
                  row.appendChild(windCell);
                }

                const snowVal = parseFloat(dayData.snow);
                const rainVal = parseFloat(dayData.rain);

                if (
                  !(
                    region.label === "DC 56: Oshawa" ||
                    region.label === "DC 17: Brampton" ||
                    region.label === "DC 26: Vancouver" ||
                    region.label === "DC 34: Calgary" ||
                    region.label === "DC 49: Winnipeg"
                  )
                ) {
                  const guidelineCell = document.createElement("td");
                  guidelineCell.textContent = calculateAdditionalTime(
                    snowVal,
                    rainVal,
                    dayData.temperature,
                    region.label,
                    city.label,
                  );
                  row.appendChild(guidelineCell);
                }

                const infoCell = document.createElement("td");
                if (!(region.label === "DC 06: Montreal")) {
                  infoCell.textContent = calculateAdditionalTime(
                    snowVal,
                    rainVal,
                    dayData.temperature,
                    region.label,
                    city.label,
                  );
                  row.appendChild(infoCell);

                  tbody.appendChild(row);
                } else {
                  infoCell.textContent = calculateAdditionalTimeMTL(
                    snowVal,
                    rainVal,
                    dayData.temperature,
                    region.label,
                    city.label,
                  );
                  row.appendChild(infoCell);
                }

                if (region.label === "DC 17: Brampton") {
                  const addedOffloadTimeCell = document.createElement("td");
                  addedOffloadTimeCell.textContent =
                    calculateAdditionalOffloadTimeBRP(
                      dayData.temperature,
                      region.label,
                      city.label,
                    );
                  row.appendChild(addedOffloadTimeCell);
                }

                tbody.appendChild(row);
              });
            }
          });

          console.log("Page rendered successfully");
        } catch (error) {
          console.error("Error:", error);
          document.querySelector("#page-container").innerHTML =
            `<p style="padding: 20px; color: red;">Error: ${error.message}</p>`;
        }
      })();

      // Function to convert city names to URL slugs
      function getCitySlug(cityName) {
        const cityMap = {
          // DC 49: Winnipeg
          Winnipeg: "ca/manitoba/winnipeg",
          Brandon: "ca/manitoba/brandon",
          Morden: "ca/manitoba/morden",
          Thompson: "ca/manitoba/thompson",
          Regina: "ca/saskatchewan/regina",
          Kenora: "ca/ontario/kenora",
          "Thunder Bay": "ca/ontario/thunder-bay",

          // DC 56: Oshawa
          Kingston: "ca/ontario/kingston",
          Lindsay: "ca/ontario/lindsay",
          Newmarket: "ca/ontario/newmarket",
          Oshawa: "ca/ontario/oshawa",
          Peterborough: "ca/ontario/peterborough",
          Picton: "ca/ontario/picton",
          Toronto: "ca/ontario/toronto",
          Ottawa: "ca/ontario/ottawa",

          // DC 06: Montreal
          Montréal: "ca/quebec/montreal",
          Québec: "ca/quebec/quebec",
          "Mont-Tremblant": "ca/quebec/mont-tremblant",
          "Val-d'Or": "ca/quebec/val-dor",
          "Sept-Îles": "ca/quebec/sept-iles",
          Magog: "ca/quebec/magog",
          Saguenay: "ca/quebec/saguenay",
          "Rouyn-Noranda": "ca/quebec/rouyn-noranda",

          // DC 17: Brampton
          Windsor: "ca/ontario/windsor",
          London: "ca/ontario/london",
          Hamilton: "ca/ontario/hamilton",
          Brampton: "ca/ontario/brampton",
          "Niagara Falls": "ca/ontario/niagara-falls",
          Kitchener: "ca/ontario/kitchener",
          Barrie: "ca/ontario/barrie",
          "Sault Ste. Marie": "ca/ontario/sault-ste-marie",
          Timmins: "ca/ontario/timmins",
          Sudbury: "ca/ontario/sudbury",

          // DC 26: Vancouver
          "Prince George": "ca/british-columbia/prince-george",
          Smithers: "ca/british-columbia/smithers",
          "Prince Rupert": "ca/british-columbia/prince-rupert",
          "Port Hardy": "ca/british-columbia/port-hardy",
          Victoria: "ca/british-columbia/victoria",
          Hope: "ca/british-columbia/hope",
          Squamish: "ca/british-columbia/squamish",
          Sechelt: "ca/british-columbia/sechelt",
          Vancouver: "ca/british-columbia/vancouver",

          // DC 34: Calgary
          Calgary: "ca/alberta/calgary",
          "Red Deer": "ca/alberta/red-deer",
          Edmonton: "ca/alberta/edmonton",
          Lethbridge: "ca/alberta/lethbridge",
          "Medicine Hat": "ca/alberta/medicine-hat",
          Lloydminster: "ca/alberta/lloydminster",
          "Grande Prairie": "ca/alberta/grande-prairie",
          "Fort McMurray": "ca/alberta/fort-mcmurray",
          "Peace River": "ca/alberta/peace-river",
          Kelowna: "ca/british-columbia/kelowna",
          Golden: "ca/british-columbia/golden",
          Kamloops: "ca/british-columbia/kamloops",
          Vernon: "ca/british-columbia/vernon",
          Revelstoke: "ca/british-columbia/revelstoke",
          "Dawson Creek": "ca/british-columbia/dawson-creek",
          Saskatoon: "ca/saskatchewan/saskatoon",
          "Prince Albert": "ca/saskatchewan/prince-albert",
          "North Battleford": "ca/saskatchewan/north-battleford",
          Melfort: "ca/saskatchewan/melfort",
          Drumheller: "ca/alberta/drumheller",
          Fernie: "ca/british-columbia/fernie",
          Bonnyville: "ca/alberta/bonnyville",
          Kindersley: "ca/saskatchewan/kindersley",
          Hinton: "ca/alberta/hinton",
          Castlegar: "ca/british-columbia/castlegar",
          Cardston: "ca/alberta/cardston",
          Invermere: "ca/british-columbia/invermere",
          Cranbrook: "ca/british-columbia/cranbrook",
        };

        return cityMap[cityName] || "";
      }

      function exportTable(table, filename) {
        var csv = [];
        var rows = table.querySelectorAll("tr");

        for (var i = 0; i < rows.length; i++) {
          var row = [];
          var cols = rows[i].querySelectorAll("td, th");
          for (var j = 0; j < cols.length; j++) {
            var data = cols[j].innerText;
            row.push(data);
          }
          csv.push(row.join(","));
        }

        var CSV_Final = csv.join("\n");
        var a = document.createElement("a");
        var bom = "\ufeff";
        a.href =
          "data:text/csv;charset=utf-8," + encodeURIComponent(bom + CSV_Final);
        a.setAttribute("download", filename);
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      }

      function copyTableToClipboard(table) {
        // Create both plain text and HTML versions
        var textRows = [];
        var rows = table.querySelectorAll("tr");

        // Build plain text version (tab-separated)
        for (var i = 0; i < rows.length; i++) {
          var row = [];
          var cols = rows[i].querySelectorAll("td, th");
          for (var j = 0; j < cols.length; j++) {
            var data = cols[j].innerText;
            row.push(data);
          }
          textRows.push(row.join("\t"));
        }
        var plainText = textRows.join("\n");

        // Create HTML version with inline styles
        var htmlTable =
          '<table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse; font-family: Arial, sans-serif; text-align: center;">';

        for (var i = 0; i < rows.length; i++) {
          htmlTable += "<tr>";
          var cols = rows[i].querySelectorAll("td, th");

          for (var j = 0; j < cols.length; j++) {
            var cell = cols[j];
            var isHeader = cell.tagName === "TH";
            var cellStyle = "";

            if (isHeader) {
              cellStyle =
                "background-color: #0036d6; color: white; font-weight: bold; padding: 10px 5px; border: 1px solid #dededf;";
            } else {
              cellStyle =
                "background-color: #ffffff; color: #000000; padding: 5px; border: 1px solid #dededf;";
            }

            var tag = isHeader ? "th" : "td";
            htmlTable +=
              "<" +
              tag +
              ' style="' +
              cellStyle +
              '">' +
              cell.innerText +
              "</" +
              tag +
              ">";
          }
          htmlTable += "</tr>";
        }
        htmlTable += "</table>";

        // Use the modern clipboard API with both formats
        if (navigator.clipboard && window.ClipboardItem) {
          const blob = new Blob([htmlTable], { type: "text/html" });
          const textBlob = new Blob([plainText], { type: "text/plain" });
          const item = new ClipboardItem({
            "text/html": blob,
            "text/plain": textBlob,
          });

          navigator.clipboard
            .write([item])
            .then(function () {
              alert("Table with formatting copied to clipboard!");
            })
            .catch(function (err) {
              console.error("Failed to copy: ", err);
              // Fallback to plain text if HTML copy fails
              fallbackCopy(plainText);
            });
        } else {
          // Fallback for browsers that don't support ClipboardItem
          fallbackCopy(plainText);
        }
      }

      function fallbackCopy(text) {
        var textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed";
        textArea.style.left = "-999999px";
        document.body.appendChild(textArea);
        textArea.select();
        try {
          document.execCommand("copy");
          alert("Table copied to clipboard (plain text)!");
        } catch (err) {
          console.error("Failed to copy: ", err);
          alert("Failed to copy table to clipboard");
        }
        document.body.removeChild(textArea);
      }
    </script>
  </head>
  <body>
    <div class="page-container" id="page-container"></div>
  </body>
</html>
